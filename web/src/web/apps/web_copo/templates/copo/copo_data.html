{% extends 'copo/base_2col.html' %}

{% load staticfiles %}
{% load web_tags %}
{% load html_tags %}

{% block stylesheet_block %}
    <!-- blueimp Gallery styles -->
    <link rel="stylesheet" href="//blueimp.github.io/Gallery/css/blueimp-gallery.min.css">
    <!-- CSS to style the file input field as button and adjust the Bootstrap progress bars -->
    <link rel="stylesheet" href="{% static 'copo/jQuery-File-Upload-master/css/jquery.fileupload.css' %}">
    <link rel="stylesheet" href="{% static 'copo/jQuery-File-Upload-master/css/jquery.fileupload-ui.css' %}">
    <!-- CSS adjustments for browsers with JavaScript disabled -->
    <noscript>
        <link rel="stylesheet" href="{% static 'copo/jQuery-File-Upload-master/css/jquery.fileupload-noscript.css' %}">
    </noscript>
    <noscript>
        <link rel="stylesheet"
              href="{% static 'copo/jQuery-File-Upload-master/css/jquery.fileupload-ui-noscript.css' %}">
    </noscript>
    <link rel="stylesheet" href="{% static 'copo/treeview/bootstrap-treeview.min.css' %}">

    <style>
        .check-icon {
            margin-right: 20px !important;
        }
    </style>

    <link rel="stylesheet" href="{% static 'copo/css/copo/copo_wizard.css' %}">
    <link rel="stylesheet" href="{% static 'copo/css/copo/datafile.css' %}">

{% endblock %}


{% block browse_header_block %}
    {% csrf_token %}
    <div hidden id="hidden_attrs">
        <!-- hidden attributes  -->
        <input type="hidden" id="nav_component_name" value="datafile"/>

        <input type="hidden" id="figshare_check_creds_url" value="{% url 'rest:check_figshare_credentials' %}"/>
        <input type="hidden" id="zipping_image" size="24px" value="{% static 'copo/img/ajax.gif' %}"/>
        <input type="hidden" id="hashing_image" size="24px" value="{% static 'copo/img/ajax.gif' %}"/>
        <input type="hidden" id="profile_id" value="{{ profile_id }}"/>
        <input type="hidden" id="profile_title" value="{{ profile.title }}"/>
        <input type="hidden" id="table_columns" value="{{ table_columns }}"/>
        <input type="hidden" value="{% url 'copo:copo_submissions' profile_id=profile_id %}" name="submission_url"
               id="submission_url"/>
        <input type="hidden" value="{{ cyverse_files }}" name="cyverse_file_data"
               id="cyverse_file_data"/>
        <input type="hidden" id="selected_datafile" value="{{ selected_file }}"/>
    </div>
{% endblock browse_header_block %}

{% block page_tile %}
    {% include "component_navbar.html" %}
{% endblock page_tile %}


{% block content %}

    <!--test ends -->

    <!--test ends -->


    <!-- datafile wizard section -->
    <div id="wizard_toggle" class="collapse" style="margin-bottom: 20px;">
        <div class="panel panel-primary">
            <div class="panel-heading">Datafile Description <span id="datafile_description_panel_title"></span></div>
            <div class="panel-body">
                <div class="fuelux" style="margin-bottom: 5px;">
                    <div class="row action-rw">
                        <!-- save for later description button -->
                        <div id="reload_act" class=" tiny ui basic secondary button"
                             data-toggle="tooltip"
                             title="Save description for later"
                             tabindex="0">
                            <span style="padding-left: 3px;">Return later</span>
                        </div>

                        <!-- show description bundle button -->
                        <div id="bundle_act" class=" tiny ui basic blue button"
                             data-toggle="tooltip"
                             title="View description bundle"
                             tabindex="0">
                            <span style="padding-left: 3px;">View bundle</span>
                        </div>

                        <!-- add to bundle button -->
                        <div id="bundle_add_act" class=" tiny ui basic teal button"
                             data-toggle="tooltip"
                             title="Add datafiles to bundle"
                             tabindex="0">
                            <span style="padding-left: 3px;">Add to bundle</span>
                        </div>

                        <!-- Help tip -->
                        <div class="pull-right">
                            <label style="font-weight: normal; margin-right: 5px;"> Help tips </label>
                            <input id="wizard-help-checkbox" type="checkbox" name="wizard-help-checkbox" checked>
                        </div>

                    </div>
                    <div class="wizard" data-initialize="wizard" id="dataFileWizard">
                        <div class="steps-container">
                            <ul class="steps">
                                <li data-step="1" data-name="intro" class="active">
                                    <span class="badge">1</span>Intro
                                    <span class="chevron"></span>
                                </li>
                                <li data-step="2" data-name="review">
                                    <span class="badge">2</span>Review
                                    <span class="chevron"></span>
                                </li>
                            </ul>
                        </div>
                        <div class="actions">
                            <div class="large ui buttons">
                                <button id="wiz_prev_btn" class="ui button btn-prev">Prev</button>
                                <div class="or"></div>
                                <button id="wiz_next_btn" class="ui primary button btn-next" data-last="Finish!">Next
                                </button>
                            </div>
                        </div>
                        <div class="step-content"
                             style="margin-bottom: 45px; border: 0.1em solid rgba(229, 239, 255, 1.0); border-radius: 4px;">
                            <div class="step-pane active datafile-pane" data-step="1">

                                <form id="wizard_form_1" class="wizard-dynamic-form">
                                    <input id="current_stage"
                                           name="current_stage"
                                           value="intro" type="hidden">
                                </form>

                                <!-- description wizard getting started section -->
                                <div class="webpop-content-div">
                                    <h4>Getting started...</h4>
                                    The following tips are provided to help you navigate the wizard:
                                    <div style="margin-top: 10px;"></div>
                                    <ol>
                                        <li>
                                            Use the <strong><a class="wiz-showme" data-target="wiz_next_btn"
                                                               data-label="Next stage" href="#"
                                                               title="show me">Next</a></strong> button to proceed
                                            to
                                            the next
                                            stage of the wizard,
                                            and the <strong><a class="wiz-showme" data-target="wiz_prev_btn"
                                                               data-label="Previous stage" href="#"
                                                               title="show me">Prev</a></strong> button to return to
                                            a
                                            previous
                                            stage
                                        </li>
                                        <li>
                                            Use the <a class="wiz-showme" data-target="wizard-help-checkbox"
                                                       data-label="Help tips" href="#"
                                                       title="show me"><strong>help tips</strong></a> button to
                                            toggle
                                            display of help
                                            tips
                                        </li>
                                        <li>
                                            The <a class="wiz-showme" data-target="copo-documentation"
                                                   data-label="Documentation" href="#"
                                                   title="show me"><strong>documentation</strong></a> page offers a
                                            more
                                            detailed guide
                                            to datafile description
                                        </li>
                                        <li>
                                            Click the <a class="wiz-showme" data-target="remove_act"
                                                         data-label="Discard description" href="#"
                                                         title="show me"><strong>discard button</strong></a> to
                                            terminate the description
                                            (and exit the wizard)

                                        </li>
                                    </ol>
                                </div>
                            </div>
                            <div class="step-pane" data-step="2">
                                <h4>Wrap up!</h4>
                                <p>
                                <div class="webpop-content-div">You have reached the final stage of the wizard.<br/>
                                    If you are satisfied with the entries you have made, click the
                                    <strong>Finish!</strong>
                                    button to finalise your description and terminate the wizard.<br/> You can still use
                                    the <strong>Prev</strong> button to go back and make changes.
                                </div>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- description bundle section -->
    <div class="desc-bundle-display-div" style="display: none;">
        <hr/>
        <div style="font-size: 18px; margin-bottom: 15px;">Description bundles
            <i style="font-size: 15px; padding-left: 3px; cursor: pointer;"
               class="fa fa-info-circle description-bundle-explained"></i>
        </div>
        <div class="desc-bundle-display-div-2"></div>
        <hr/>
        <div style="margin-bottom: 15px;">&nbsp;</div>
    </div>

    <!-- datafile table section -->
    <div style="margin-top: 15px;">
        <!-- getting started section -->
        <div class="row">
            <div class="col-sm-5 col-md-5 col-lg-5 col-xs-offset-0 page-welcome-message"
                 style="display: none;">
                <div class="copo-webui-popover">
                    <div class="webui-popover-inner">
                        <h3 class="copo-webui-popover-title">Datafiles - Getting started</h3>
                        <div class="copo-webui-popover-content">
                            <div class="webpop-content-div">
                                The datafiles component enables the user to upload datafiles to COPO,
                                and also attribute metadata to the uploaded files.
                                <div style="margin-top: 10px;"></div>
                                <ol>
                                    <li>
                                        <div><strong>Upload: </strong>
                                            Use the <i>Upload</i> tab on the right-hand side to
                                            access the file upload functionality.
                                            Single or multiple files can be uploaded at once.
                                            COPO attempts to compress (larger files) and <i>hash</i>
                                            uploaded datafiles.
                                            <br/>
                                            <span style="color:#ff0000;">For improved user experience, large files (e.g., size >=1GB)
                                                should be compressed (<i>gzipped</i>) before attempting an
                                            upload to COPO.
                                        </span>
                                        </div>
                                    </li>
                                    <li>
                                        <div><strong>View: </strong>
                                            Information about uploaded files is displayed in a tabular format,
                                            with
                                            different functions (e.g., <i>describe</i>), to facilitate
                                            manipulation of
                                            uploaded datafiles.
                                        </div>
                                    </li>
                                    <li>
                                        <div><strong>Describe: </strong>
                                            Using the describe functionality, the user can attribute metadata to
                                            datafiles
                                            with the aid of a <i>description wizard</i>.
                                            The description wizard can
                                            be initiated by selecting one or more target
                                            files, and clicking the <i>Describe</i>
                                            button.
                                            The wizard guides the user through a sequence of
                                            steps of metadata attribution.
                                        </div>
                                    </li>
                                </ol>
                                <div><strong>Quick Tour: </strong>To explore the various
                                    controls available on this page, click the
                                    <button class="circular tiny ui icon orange button">
                                        <i class="icon lightbulb"></i>
                                    </button>
                                    icon.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="cover-spin"></div>

    <!-- datafile table -->
    <div id="component_table_loader" class="col-sm-5 col-md-5 col-lg-5 col-xs-offset-5"
         data-copo-tour-id="datafile_table"></div> <!-- div used by the quick tour agent -->
    <table id="datafile_table"
           class="ui celled table hover copo-noborders-table"
           cellspacing="0" width="100%">
    </table>
    <br/><br/>


{% endblock %}

{% block help_section %}

{% endblock %}


{% block js_block %}
    <script src="{% static 'copo/js/generic_handlers.js' %}"></script>
    <script src="{% static 'copo/js/generic_handlers_ext2.js' %}"></script>
    <script src="{% static 'copo/js/copo_form_handlers.js' %}"></script>
    <script src="{% static 'copo/js/copo_data.js' %}"></script>
    <script src="{% static 'copo/js/jquery.form.js' %}"></script>
    <script src="{% static 'copo/js/bootstrapValidator.js' %}"></script>
    <script src="{% static 'copo/jQuery-File-Upload-master/js/vendor/jquery.ui.widget.js' %}"></script>
    <script src="{% static 'copo/jQuery-File-Upload-master/js/jquery.iframe-transport.js' %}"></script>
    <script src="{% static 'copo/jQuery-File-Upload-master/js/jquery.fileupload.js' %}"></script>
    <script src="{% static 'copo/jQuery-File-Upload-master/js/jquery.fileupload-process.js' %}"></script>
    <script src="{% static 'copo/jQuery-File-Upload-master/js/jquery.fileupload-ui.js' %}"></script>
    <script src="{% static 'copo/js/uploader_old/ena_upload_wrapper.js' %}"></script>
    <script src="{% static 'copo/js/uploader_old/bootstrap_panel.js' %}"></script>
    <script src="{% static 'copo/js/uploader_old/upload_util.js' %}"></script>
    <script src="{% static 'copo/js/progressbar.js' %}"></script>
    <script src="{% static 'copo/treeview/bootstrap-treeview.min.js' %}"></script>

{% endblock %}
